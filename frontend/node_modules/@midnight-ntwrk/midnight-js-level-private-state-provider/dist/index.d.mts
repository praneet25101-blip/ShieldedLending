import { PrivateStateId, WalletProvider, PrivateStateProvider } from '@midnight-ntwrk/midnight-js-types';
import { Buffer } from 'buffer';

type PrivateStoragePasswordProvider = () => string | Promise<string>;
declare class StorageEncryption {
    private readonly encryptionKey;
    private readonly salt;
    constructor(password: string, existingSalt?: Buffer);
    private deriveKey;
    encrypt(data: string): string;
    decrypt(encryptedData: string): string;
    static isEncrypted(data: string): boolean;
    getSalt(): Buffer;
}

/**
 * Optional properties for the indexedDB based private state provider configuration.
 */
interface LevelPrivateStateProviderConfig {
    /**
     * The name of the LevelDB database used to store all Midnight related data.
     */
    readonly midnightDbName: string;
    /**
     * The name of the object store containing private states.
     */
    readonly privateStateStoreName: string;
    /**
     * The name of the object store containing signing keys.
     */
    readonly signingKeyStoreName: string;
    /**
     * Wallet provider used to get the encryption public key for password derivation.
     * If privateStoragePasswordProvider is not provided, the wallet's encryption public key
     * will be used as the password.
     */
    readonly walletProvider?: WalletProvider;
    /**
     * Provider function that returns the password used for encrypting private state.
     * The password must be at least 16 characters long.
     *
     * If not provided, defaults to using walletProvider.getEncryptionPublicKey().
     *
     * @example
     * ```typescript
     * // Using default (wallet's encryption public key)
     * { walletProvider: wallet }
     *
     * // Using custom password provider
     * {
     *   walletProvider: wallet,
     *   privateStoragePasswordProvider: async () => await getUserPassword()
     * }
     * ```
     */
    readonly privateStoragePasswordProvider?: PrivateStoragePasswordProvider;
}
/**
 * The default configuration for the level database.
 */
declare const DEFAULT_CONFIG: {
    /**
     * The name of the database.
     */
    midnightDbName: string;
    /**
     * The name of the "level" on which to store private state.
     */
    privateStateStoreName: string;
    /**
     * The name of the "level" on which to store signing keys.
     */
    signingKeyStoreName: string;
};
/**
 * Constructs an instance of {@link PrivateStateProvider} based on {@link Level} database.
 *
 * @param config Database configuration options.
 */
declare const levelPrivateStateProvider: <PSI extends PrivateStateId, PS = any>(config: Partial<LevelPrivateStateProviderConfig>) => PrivateStateProvider<PSI, PS>;

export { DEFAULT_CONFIG, StorageEncryption, levelPrivateStateProvider };
export type { LevelPrivateStateProviderConfig, PrivateStoragePasswordProvider };
